# Challenge Source Code
```
#include <err.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>

#define BANNER \
    "Welcome to " LEVELNAME ", brought to you by https://exploit.education"

char *what = GREET;

char *greet(char *who) {
    char buffer[128];
    int maxSize;

    maxSize = strlen(who);
    if (maxSize > (sizeof(buffer) - /* ensure null termination */ 1)) {
    maxSize = sizeof(buffer) - 1;
}

    strcpy(buffer, what);
    strncpy(buffer + strlen(buffer), who, maxSize);

    return strdup(buffer);
}

int main(int argc, char **argv) {
    char *ptr;
    printf("%s\n", BANNER);

#ifdef NEWARCH
    if (argv[1]) {
        what = argv[1];
    }
#endif

    ptr = getenv("ExploitEducation");
    if (NULL == ptr) {
    // This style of comparison prevents issues where you may accidentally
    // type if(ptr = NULL) {}..

    errx(1, "Please specify an environment variable called ExploitEducation");
    }

    printf("%s\n", greet(ptr));
    return 0;
}
```
# Challenge Theory
This challenge is a 1 byte buffer overflow.
You have overwrite a single byte and then point it to something to get code execution.
# Working on the Challenge
Setting the environment variable "ExploitEducation" outside of gdb will be done.
Also the "GREET" macro simply creates the string "Welcome, I am pleased to meet you".
This has the length of 34.
The buffer for the challenge is 128, but only 127 bytes can be read in.
This means 34 + 127 = 161, and according the dissassembly there is a total 168 on the stack frame.
```
0x00000000004006fd <+0>:     push   rbp
0x00000000004006fe <+1>:     mov    rbp,rsp
0x0000000000400701 <+4>:     push   rbx
0x0000000000400702 <+5>:     sub    rsp,0xa8
```
All of this combined means only the least significant bit can actually be overwritten.
Therefore, this exploit needs to be a bit more creative.
Taking at the stack with a 127 byte payload it has:
```
0x7fffffffe4f0: 0x2c656d6f636c6557      0x6c70206d61204920
0x7fffffffe500: 0x6f74206465736165      0x6f79207465656d20
0x7fffffffe510: 0x4141414141412075      0x4141414141414141
0x7fffffffe520: 0x4141414141414141      0x4141414141414141
0x7fffffffe530: 0x4141414141414141      0x4141414141414141
0x7fffffffe540: 0x4141414141414141      0x4141414141414141
0x7fffffffe550: 0x4141414141414141      0x4141414141414141
0x7fffffffe560: 0x4141414141414141      0x4141414141414141
0x7fffffffe570: 0x4141414141414141      0x4141414141414141
0x7fffffffe580: 0x4141414141414141      0x4141414141414141
0x7fffffffe590: 0x00007fffffffe541      0x00000000004007e9
```
The least significat byte of the address at "0x7fffffffe590" is changed to "41".

